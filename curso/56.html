<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="../jquery-3.6.0.min.js"></script>
    <title>Convertir imagen en blanco y negro</title>
</head>
<body>
    <h1>Algun titulo</h1>
    <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Animi expedita praesentium nemo quae harum cupiditate molestiae aliquid distinctio dolor libero.</p>

    <button>Blanco y Negro</button>
    <canvas id="can" width="220" height="319"></canvas>

    <script>
        var img = $('<img>');
            canvas = $('canvas')[0]
            context = canvas.getContext('2d')

        img.on('load',function(){
            context.drawImage(this,0,0);
        })

        img.attr('src','assets/img/Katy_Perry.jpg')

        $('button').on('click',function(){
            var imageData = context.getImageData(0,0,canvas.width,canvas.height)
                px = imageData.data,
                gray = 0;

            for(var i=0;i<px.length;i+=4){
                gray = (px[i]+px[i+1]+px[i+2])/3;
                px[i] = gray
                px[i+1] = gray
                px[i+2] = gray
            }

            context.putImageData(imageData,0,0)
        })
    </script>
    
</body>
</html>